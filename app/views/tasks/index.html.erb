<!DOCTYPE html>
<html>
<head>
  <% if user_signed_in? %>
    <div>
      <%= link_to user_avatar(current_user.first_name) , show_user_registration_path%>
      <%= link_to "Home", root_path %>
      <%= link_to 'Logout', destroy_user_session_path, method: :delete %>
    </div>
    <% else %>
    <% end %>
  <h3>Task Manager</h3>
</head>
<body>
  <div>
    <%= form_tag(tasks_path, method: "get", class: "container") do %>
    <%= text_field_tag :search, params[:search], placeholder: "Search" %>
    <%= submit_tag "Search", class: "btn btn-primary" %>
    <% end %>
  </div>
  <div>
    <br>
    <%= link_to "High priority to do tasks", highpriority_tasks_path, class: "task-links" %>
  </div>
  <br>
  <div><h4>Tasks</h4></div>
  <table class="table">
    <thead class="thead-dark">
      <tr>
        <th scope="col">Title</th>
        <th scope="col">Status</th>
        <th scope="col">Priority</th>
        <th scope="col">Time estimate</th>
        <th scope="col">Due date</th>
      </tr>
    </thead>
    
    <% @tasks.each do |task|%>
    <tbody>
        <tr>
          <td > <%= link_to task.title, task %></td>
          <td > <%= task.status %></td>
          <td > <%= task.priority %></td>
          <td > <%if task.estimate != nil%> <%= distance_of_time_in_words(Time.now, Time.now + task.estimate.seconds)%><%end%> </td>
          <td > <%if task.due_date != nil%> <%= task.due_date.in_time_zone('Africa/Johannesburg').strftime("%Y-%b-%d %I:%M%p") %><%end%> </td>
          
        </tr>
    </tbody>
     <%end%>
  </table>

  <div>
    <%= link_to "New Task", new_task_path, class: "bottom-task" %>
    <%= paginate @tasks,  class: "pagination"%>
   </div>

   
</body>
</html>
